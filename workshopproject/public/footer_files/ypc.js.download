(function(g){var window=this;var XKa=function(a,b){this.heading=a.xc?b.title:a.Am;this.buttonLabel=a.zm;this.i=a.Ox;this.description=a.Cj;this.u=a.uj;this.offerId=a.Bm;this.B=a.tm;this.thumbnail=a.wm;g.ux(this.thumbnail)||(this.thumbnail="");this.title=a.xm;this.l=a.ym;this.videoId=a.Cm},U8=function(){g.VL.call(this,{D:"div",
ga:["ytp-drawer",g.sT.STOP_EVENT_PROPAGATION],N:[{D:"div",J:"ytp-drawer-content",Y:"{{content}}"},{D:"button",ga:["ytp-drawer-close-button","ytp-button"],N:[g.$L()]},{D:"button",ga:["ytp-drawer-open-button","ytp-button"]}]});var a=this,b=this.ea("ytp-drawer-close-button");this.L(b,"click",this.vj);b=this.ea("ytp-drawer-open-button");this.L(b,"click",this.show);this.i=new g.I(function(){g.sn(a.element,"ytp-drawer-closed")},0);
g.D(this,this.i);this.Bc(null);this.hide()},V8=function(a,b,c,d){g.O.call(this);
this.drawer=new U8;this.endScreen=g.Ce("DIV");this.template=new g.V({D:"div",J:"html5-ypc-module",N:[{D:"div",J:"html5-ypc-action-heading",Y:"{{heading}}"},{D:"div",J:"html5-ypc-thumbnail",Y:"{{thumbnail_element}}"},{D:"div",J:"html5-ypc-title",Y:"{{title}}"},{D:"div",J:"html5-ypc-description",Y:"{{description}}"},{D:"button",ga:["html5-ypc-purchase","ytp-button"],Y:"{{button_label}}"}]});this.purchaseButton=this.template.ea("html5-ypc-purchase");this.i=0===d;this.drawer.subscribe("close-clicked",
this.l,this);g.D(this,this.drawer);g.K(this.endScreen,"html5-ypc-endscreen");g.D(this,this.template);this.template.L(this.purchaseButton,"click",this.u,this);d=c.title;c.l&&(d={D:"a",R:{href:c.l,target:"blank_"},Y:c.title});var e="";c.thumbnail&&(e={src:c.thumbnail},"sponsors_only_video"===c.offerId&&(e["class"]="avatar"),e={D:"img",R:e});var f;c.i?f=g.yG(c.i):f=c.buttonLabel;this.template.update({heading:c.heading,title:d,thumbnail_element:e,description:c.description,button_label:f});this.purchaseButton.style.display=
this.purchaseButton.textContent?"":"none";this.ca(a,b)},YKa=function(a){a.i||(a.endScreen.appendChild(a.template.element),a.drawer.Bc(null),a.endScreen.style.display="block")},W8=function(a){g.O.call(this);
this.i=new g.V({D:"div",J:"html5-ypc-module",N:[{D:"button",ga:["html5-ypc-purchase-refined","ytp-button"],Y:"{{offer_button_label}}"}]});g.D(this,this.i);var b=a.i?g.yG(a.i):a.buttonLabel;this.i.update({offer_button_label:b});this.l=this.i.ea("html5-ypc-purchase-refined");this.i.L(this.l,"click",this.u,this);a.videoId||(g.K(this.l,"html5-ypc-purchase-refined-inactive-playback"),a=g.Ce("DIV"),g.K(a,"html5-ypc-endscreen"),a.style.display="block",this.i.element.appendChild(a))},X$=function(a){g.iO.call(this,
a);
var b=this;this.u=this.l=this.I=this.i=null;this.Lu=!1;this.T=new g.I(function(){var c=b.l;c.i||c.drawer.hide()},0);
this.K=new g.I(function(){g.sn(b.u.l,"html5-ypc-purchase-refined-highlighted")},0);
this.C=this.B=null;this.listeners=new g.aO(this);this.G=a.P();g.D(this,this.listeners);g.D(this,this.T);g.D(this,this.K)},ZKa=function(a){g.Q(a.G.experiments,"html5_ypc_release_killswitch")?a.player.Cn():g.nm(function(){a.player.Ql(void 0)})},$Ka=function(a,b){var c=1E4;
isNaN(b.Dj)||(c=b.Dj);a.l=new V8(a.C.element,a.B.element,a.i,c);a.l.subscribe("ypcContentRequest",a.hF,a);if(g.Zoa(a.player.Ra())){var d=new g.oG(0x8000000000000,0x8000000000000,{priority:2,namespace:"ypc"});a.player.Gd([d])}d=a.l;d.i||d.drawer.show();a.T.start(c)},bLa=function(a){a.u=new W8(a.i);
a.u.subscribe("ypcContentRequest",a.hF,a);a.B.element.appendChild(a.u.i.element);aLa(a);g.Q(a.G.experiments,"make_refined_offer_overlay_fading_away")&&(a.listeners.L(a.player,"onShowControls",function(){aLa(a)}),a.listeners.L(a.player,"onHideControls",function(){a.K.start(5E3)}))},aLa=function(a){a.K.stop();
a.u.highlight()};g.u(U8,g.VL);U8.prototype.vj=function(){this.hide();this.S("close-clicked")};
U8.prototype.hide=function(){this.i.stop();g.K(this.element,"ytp-drawer-closed")};
U8.prototype.Bc=function(a){a?(g.VL.prototype.Bc.call(this,a),this.element.style.display="block"):this.element.style.display="none"};
U8.prototype.show=function(){this.i.start()};g.u(V8,g.O);V8.prototype.aa=function(){g.O.prototype.aa.call(this);this.i||g.Ge(this.endScreen)};
V8.prototype.ca=function(a,b){this.i||(this.drawer.ca(b),this.drawer.Bc(this.template.element),a.appendChild(this.endScreen))};
V8.prototype.l=function(){this.S("ypcModuleCloseClicked")};
V8.prototype.u=function(){this.S("ypcContentRequest")};g.u(W8,g.O);W8.prototype.highlight=function(){g.K(this.l,"html5-ypc-purchase-refined-highlighted")};
W8.prototype.u=function(){this.S("ypcContentRequest")};g.u(X$,g.iO);g.k=X$.prototype;g.k.reload=function(a){this.l&&"dataupdated"===a||(this.unload(),this.load())};
g.k.load=function(){var a=this,b,c,d,e;if(!this.loaded){g.iO.prototype.load.call(this);this.listeners.L(this.player,g.rG("ypc"),function(m){a.ud(m)});
this.listeners.L(this.player,g.sG("ypc"),function(m){a.jf(m)});
this.listeners.L(this.player,"videodatachange",function(m){a.reload(m)});
var f=this.player.getVideoData(),h=this.player.getVideoData(1);this.i=new XKa(f,h);if(!this.i.videoId&&!f.Pf||f.ypcPreview)g.WC(this.G)||(this.B=new g.V({D:"div",ga:["ytp-player-content"]}),this.C=new g.V({D:"div",ga:["ytp-ypc-player-content"],N:[this.B]}),g.ZN(this.player,this.C.element,4),this.i.videoId&&(this.I=new g.V({D:"div",J:"html5-ypc-overlay",Y:this.i.u}),this.I.ca(this.B.element)),this.i.offerId&&!g.Q(this.G.experiments,"hide_video_offer_overlay_on_web")&&(g.Q(this.G.experiments,"use_refined_video_offer_overlay_on_web")?
bLa(this):$Ka(this,f))),!this.i.videoId&&this.i.offerId?(this.l&&YKa(this.l),ZKa(this),this.Lu=!0,this.player.ra("ypcStateChanged",!0)):f.ypcPreview?(this.player.ra("ypcStateChanged",!0),this.player.cd("ypc")):this.i.offerId||this.player.cd("ypc");else{h={autoplay:"1",oauth_token:f.oauthToken,video_id:this.i.videoId,ypc_buy_url:f.tm,ypc_full_video_message:f.uj,ypc_item_thumbnail:f.wm,ypc_item_title:f.xm,ypc_item_url:f.ym,ypc_module:"1",ypc_offer_button_text:f.zm,ypc_offer_button_formatted_text:f.uE,
ypc_offer_description:f.Cj,ypc_offer_headline:f.Am,ypc_offer_id:f.Bm,ypc_origin:f.videoId,ypc_overlay_timeout:f.Dj,ypc_preview:"1",ypc_vid:f.Cm,ypc_original_itct:f.fa};if(f.isPremiere){var l=f.getPlayerResponse();(l=null===(e=null===(d=null===(c=null===(b=null===l||void 0===l?void 0:l.playabilityStatus)||void 0===b?void 0:b.liveStreamability)||void 0===c?void 0:c.liveStreamabilityRenderer)||void 0===d?void 0:d.offlineSlate)||void 0===e?void 0:e.liveStreamOfflineSlateRenderer)&&Object.assign(h,{ypc_is_premiere_trailer:f.isUpcoming,
ypc_offer_headline:l.mainText?g.T(l.mainText):"",ypc_offer_description:f.Cj})}f.Pf&&Object.assign(h,f.Pf);f=f.isUpcoming?8:1;this.player.vi(f);this.player.loadVideoByPlayerVars(h,!0,f)}}};
g.k.create=function(){this.load()};
g.k.unload=function(){this.C&&(this.C.dispose(),this.C=null,this.B.dispose(),this.B=null);g.St(this.listeners);this.player.Me("ypc");this.T.stop();this.K.stop();g.Zf(this.I,this.l,this.u);this.u=this.l=this.I=null;g.iO.prototype.unload.call(this);this.player.ra("ypcStateChanged",!1)};
g.k.ud=function(){YKa(this.l);this.Lu=!0;this.player.ra("ypcStateChanged",!0)};
g.k.jf=function(){var a=this.l;a.i||(a.endScreen.style.display="none",a.drawer.Bc(a.template.element));this.Lu=!1;this.player.ra("ypcStateChanged",!0)};
g.k.hF=function(){var a=this.i.B;a?g.UC(this.player.P())?g.GK(a):g.nka(a):this.i.offerId&&(this.player.isFullscreen()&&this.player.toggleFullscreen(),this.player.ra("onYpcContentRequest",this.i.offerId))};
g.k.xi=function(a){return 2===a&&this.player.Ra().Yr()?!1:!0};g.oO.ypc=X$;})(_yt_player);
